ðŸš¨ 1. Error: streak.activities is not iterable
âŒ Problem:
You're likely trying to spread or iterate over streak.activities, but activities is either:

undefined, or

not an array.

From the error stack, this line is the problem:

ts
Copy
Edit
const updatedActivities = [...streak.activities, newActivity];
If streak.activities is undefined (e.g., on first run), spreading it throws the error.

âœ… Fix:
Make sure streak.activities is always initialized as an array before you spread:

ts
Copy
Edit
const updatedActivities = [
  ...(Array.isArray(streak.activities) ? streak.activities : []),
  newActivity,
];
ðŸ§  2. Streaks Should Be Based on Study Sessions (Not Just Pomodoro Completion)
You're absolutely right. Here's how you should structure it:

âœ… Track streaks based on:
Explicit study sessions (could be triggered by a manual "Start Session" or "Mark as Studied" action per subject)

OR based on actual test completions

Do not make PomodoroTimer automatically add to streaks â€” instead, use it for tracking time spent per subject (for recommendations only).

âœ… Updated Feature Architecture
Feature	Based on	Storage Key	Displayed Where
Study Streak	studySessions[] = [{ date, subject }]	localStorage / DB	Study Tools > Badge
Recommendations	testRecords[] + pomodoroLogs[]	localStorage / DB	Smart Recos
Pomodoro Stats	pomodoroLogs[] = [{ subject, duration, date }]	Local	Dashboard Chart

ðŸ›  What to Fix/Build Now
âœ… Fix the crash:

ts
Copy
Edit
const updatedActivities = [
  ...(Array.isArray(streak.activities) ? streak.activities : []),
  newActivity,
];
âœ… Create a proper studySessions[] logger:

Allow user to click â€œStart Study Sessionâ€

Ask for subject

Push { date: today, subject } to studySessions

âœ… Recalculate streaks from studySessions[]

ts
Copy
Edit
const dates = [...new Set(studySessions.map(s => s.date))].sort()
const { current, longest } = calculateStreak(dates)
âœ… Rebuild Recommendations:

Use pomodoroLogs[] + testRecords[] to check â€œlast studiedâ€ date per subject

If daysSince > 3, show a rec